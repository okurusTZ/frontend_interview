#### 浏览器渲染机制

* 浏览器采用流式布局
* 浏览器会把HTML解析成DOM，把css解析成CSSOM，DOM和CSSOM合并就成了渲染树
* 有了渲染树，知道所有节点的样式，然后计算他们在页面上的大小和位置，最后把节点绘制到页面上。

一个页面从加载到完成，首先构建DOM树，然后根据DOM节点的几何属性去构建渲染树，当渲染树构建完成时，页面就根据DOM树开始布局了，渲染树也根据设置的样式对应地渲染这些节点。

#### 回流

与DOM树和渲染树有关

* 增删节点
* 修改元素宽高
* 会让页面布局发生变化的操作

DOM树的结构发生变化，需要重新构建。而渲染树也会随之对页面进行再次地渲染。

#### 重绘

只与渲染树有关。

* 更换颜色
* 不影响页面布局的操作

DOM树不发生变化，但颜色变了，渲染树需要重新渲染页面，**这就是重绘**



##### 补充

1. display：none的元素在页面不需要渲染，渲染树不包括这个节点（脱离文档流
2.  visibility为hidden的元素会在渲染树中。虽然看不到，但类似于opacity：0，还在文档流中。



#### 如何减少回流

1. 增删节点时，利用documentfragment（？）
2. 几何属性变化时，最好把多个属性定义在一个类里，这样可以只引起一次回流
3. 元素位置变化：不要更改margin、padding等属性，使用定位脱离文档流后改变位置会更好
4. 获取元素的偏移值：为了保证获取值的正确性，也会回流取得最新的值，所以如果要多次操作，最好取完值做个缓存。
5. 避免使用<table>，一个很小的改动会造成整个table的重新布局